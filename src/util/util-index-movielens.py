import pandas as pd

# Supondo que G seja o seu dicionário original e tabela seja o DataFrame carregado do Excel
# Age
#G = {1: [1088, 1425, 2288, 5074, 5555], 2: [192, 202, 302, 352, 438, 524, 531, 770, 869, 881, 1112, 1117, 1120, 1137, 1246, 1447, 1605, 1613, 1647, 1676, 1733, 1889, 1943, 2010, 2015, 2073, 2077, 2106, 2116, 2777, 3029, 3163, 3308, 3312, 3389, 3391, 3471, 3648, 3884, 3942, 4041, 4387, 4411, 4579, 5011, 5359, 5367, 5394, 5530, 5605, 5682, 5824, 5964], 3: [48, 53, 149, 169, 195, 308, 424, 482, 509, 533, 543, 549, 678, 692, 710, 752, 802, 839, 877, 1010, 1051, 1150, 1194, 1203, 1244, 1260, 1264, 1266, 1303, 1333, 1340, 1354, 1383, 1448, 1579, 1632, 1635, 1639, 1680, 1712, 1812, 1835, 1837, 1912, 1958, 1983, 1988, 2012, 2041, 2063, 2102, 2105, 2109, 2181, 2223, 2453, 2507, 2638, 2857, 2887, 2895, 2909, 2986, 3032, 3067, 3080, 3118, 3182, 3224, 3280, 3285, 3311, 3462, 3475, 3491, 3507, 3519, 3539, 3562, 3626, 3650, 3681, 3683, 3693, 3768, 3778, 3792, 3808, 3821, 3824, 3829, 3916, 3929, 3934, 4033, 4058, 4085, 4089, 4115, 4140, 4186, 4227, 4312, 4344, 4345, 4386, 4448, 4508, 4543, 4578, 4607, 4682, 4715, 4728, 4732, 4867, 4957, 5026, 5046, 5113, 5220, 5256, 5306, 5312, 5333, 5387, 5501, 5536, 5614, 5627, 5636, 5759, 5763, 5788, 5795, 5812, 5831, 5880, 5886, 5888, 5996, 6036], 4: [123, 245, 264, 329, 721, 1015, 1019, 1101, 1181, 1202, 1285, 1298, 1422, 1449, 1451, 1698, 1737, 1741, 1780, 1880, 1920, 1941, 1980, 2529, 2537, 2665, 2793, 2820, 2907, 3018, 3272, 3336, 3401, 3410, 3526, 3675, 3724, 3842, 3999, 4007, 4048, 4238, 4271, 4277, 4354, 4425, 4482, 4647, 4673, 4725, 4808, 4979, 5015, 5054, 5433, 5550, 5643, 5675], 5: [216, 411, 550, 660, 889, 1317, 1884, 1899, 2304, 2484, 2544, 3483, 3589, 3705, 3841, 4064, 4305, 4447, 4510, 5107, 5504, 5511, 5954, 6016], 6: [148, 319, 911, 984, 1207, 2878, 3292, 4016, 4021, 4169, 5100, 5916], 7: [2092, 3618, 3823, 4083, 4802, 5686]}

# Gender
G = {1: [48, 53, 123, 148, 149, 169, 192, 195, 202, 216, 245, 264, 302, 308, 329, 352, 424, 438, 482, 509, 524, 533, 543, 549, 550, 660, 678, 710, 770, 802, 839, 869, 877, 881, 889, 911, 984, 1010, 1015, 1019, 1101, 1112, 1117, 1120, 1137, 1181, 1202, 1207, 1244, 1246, 1260, 1264, 1266, 1285, 1298, 1303, 1317, 1333, 1340, 1422, 1425, 1447, 1449, 1451, 1579, 1613, 1632, 1635, 1639, 1647, 1676, 1680, 1698, 1712, 1733, 1737, 1741, 1780, 1835, 1837, 1880, 1884, 1889, 1912, 1941, 1943, 1980, 1983, 2010, 2012, 2015, 2063, 2077, 2092, 2102, 2105, 2109, 2116, 2181, 2223, 2288, 2304, 2453, 2484, 2507, 2537, 2544, 2638, 2665, 2777, 2793, 2857, 2887, 2895, 2909, 2986, 3018, 3029, 3032, 3080, 3118, 3163, 3182, 3272, 3280, 3285, 3311, 3336, 3389, 3391, 3401, 3410, 3471, 3475, 3491, 3507, 3526, 3618, 3626, 3648, 3650, 3675, 3681, 3683, 3693, 3705, 3724, 3768, 3778, 3792, 3808, 3821, 3823, 3824, 3841, 3884, 3916, 3929, 3934, 3942, 3999, 4007, 4016, 4021, 4033, 4041, 4058, 4064, 4083, 4089, 4115, 4140, 4169, 4186, 4227, 4238, 4271, 4277, 4312, 4344, 4354, 4386, 4411, 4425, 4447, 4448, 4508, 4510, 4543, 4578, 4607, 4647, 4673, 4682, 4715, 4725, 4728, 4732, 4802, 4808, 4867, 4957, 4979, 5011, 5015, 5026, 5046, 5054, 5074, 5100, 5113, 5220, 5256, 5312, 5359, 5367, 5394, 5501, 5504, 5511, 5536, 5550, 5555, 5614, 5627, 5636, 5675, 5682, 5686, 5788, 5795, 5824, 5831, 5880, 5886, 5888, 5916, 5954, 5964, 6016], 2: [319, 411, 531, 692, 721, 752, 1051, 1088, 1150, 1194, 1203, 1354, 1383, 1448, 1605, 1812, 1899, 1920, 1958, 1988, 2041, 2073, 2106, 2529, 2820, 2878, 2907, 3067, 3224, 3292, 3308, 3312, 3462, 3483, 3519, 3539, 3562, 3589, 3829, 3842, 4048, 4085, 4305, 4345, 4387, 4482, 4579, 5107, 5306, 5333, 5387, 5433, 5530, 5605, 5643, 5759, 5763, 5812, 5996, 6036]}

tabela = pd.read_excel("util-index-movielens.xlsx")

# Cria um dicionário mapeando UserID para UserID_Index a partir do DataFrame
user_id_to_index = dict(zip(tabela['UserID'], tabela['UserID_Index']))

# Função para substituir os UserID por UserID_Index em cada lista do dicionário G
def replace_user_ids(group_dict, replacement_dict):
    new_dict = {}
    for group, users in group_dict.items():
        # Substitui cada UserID pelo UserID_Index correspondente
        new_dict[group] = [replacement_dict[user] for user in users]
    return new_dict

# Aplica a substituição usando a função definida
G_updated = replace_user_ids(G, user_id_to_index)

print(G_updated)
